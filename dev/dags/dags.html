
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pipelines overview &#8212; samgen  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running pipelines" href="../tech_docs/tech_docs.html" />
    <link rel="prev" title="System overview" href="../overview/overview.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pipelines-overview">
<h1>Pipelines overview<a class="headerlink" href="#pipelines-overview" title="Permalink to this headline">¶</a></h1>
<section id="germline-exome">
<h2>germline-exome<a class="headerlink" href="#germline-exome" title="Permalink to this headline">¶</a></h2>
<img alt="../_images/germline-exome.png" src="../_images/germline-exome.png" />
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h3>
<section id="introduction">
<h4>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h4>
<p>Germline exome workflow based on <a class="reference external" href="https://github.com/sysamgen/analysis-workflows/blob/master/definitions/pipelines/germline_exome.cwl">mgi-germline-exome</a>.</p>
<p>This worfklow completes exome alignment and germline variant detection using a variety of tools.
The initial processing of sequence is performed by picard, alignment is performed by bwa. Output bam file undergoes qc process resulting in
insert_size_metrics, alignment_summary_metrics, hs_metrics and flagstat. VerifyBamId step checks if reads are not contaminated as a mixture of two samples.
Variants are detected using GATK HaplotypeCaller tool.</p>
</section>
<section id="alignment-and-qc-step">
<h4>Alignment and QC step<a class="headerlink" href="#alignment-and-qc-step" title="Permalink to this headline">¶</a></h4>
<p>Germline pipeline starts with either fastq files or unaligned BAM files with necessary metadata describing analysis type, sample name and phenotype.</p>
<img alt="../_images/alignment_qc.png" src="../_images/alignment_qc.png" />
<p>Used tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="10.1093/bioinformatics/btp324">bwa_mem 0.7.15</a> - for sequence alignment step using GRCh38 reference</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1093/bioinformatics/btu314">samblaster 0.1.24</a> - for adding mate tags</p></li>
<li><p><a class="reference external" href="10.3390/biology1030895">flexbar 3.5</a> - for bar and adapter removal</p></li>
<li><p><a class="reference external" href="http://broadinstitute.github.io/picard/">picard:2.23.6</a> for alignment metrics</p></li>
<li><p><a class="reference external" href="10.1093/bioinformatics/btp352">samtools 1.11–h6270b1f_0</a> for BAM indexing and flagstat operation</p></li>
<li><p><a class="reference external" href="http://broadinstitute.github.io/picard/">picard 2.18.1</a> - for bedtointervals operation</p></li>
<li><p><a class="reference external" href="10.1101/gr.107524.110">gatk 4.1.8.1</a>  for Select Variants</p></li>
<li><p><a class="reference external" href="doi:10.1016/j.ajhg.2012.09.004">verifyBamId v1.1.3</a> - for checking whether the reads are contaminated as a mixture of two samples</p></li>
<li><p><a class="reference external" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">fastqc</a> - for bam QC report</p></li>
<li><p><a class="reference external" href="10.1093/bioinformatics/btv566">qualimap</a> - for bam QC report</p></li>
</ul>
</section>
<section id="detect-variants-step">
<h4>Detect variants step<a class="headerlink" href="#detect-variants-step" title="Permalink to this headline">¶</a></h4>
<img alt="../_images/detect_variants.png" src="../_images/detect_variants.png" />
<p>Used tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="10.1101/gr.107524.110">gatk:4.1.8.1</a> Haplotype Caller for variant (SNPs and indels) detection</p></li>
<li><p><a class="reference external" href="10.1093/gigascience/giab008">bcftools</a> - QC for detected variants</p></li>
</ul>
</section>
<section id="variants-post-processing">
<h4>Variants post-processing<a class="headerlink" href="#variants-post-processing" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>After variants are detected by Haplotype Caller they are subject  decomposition and normalization to assure coherent variant representation.
Once variants are standardized they are annotated with metadata collected and published by public databases.
In the afterburner step final postprocessing is performed including generating URLs to external databases and extracting genotype information from INFO field.</p>
<p>Used tools:</p>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1093/bioinformatics/btv112">vt 0.57721–hf74b74d_1</a> - for normalization and decomposition</p></li>
<li><p><a class="reference external" href="doi:10.1186/s13059-016-0974-4">vep 111</a> - for variants annotations</p></li>
</ul>
</section>
<section id="loading-variants-to-database">
<h4>Loading variants to database<a class="headerlink" href="#loading-variants-to-database" title="Permalink to this headline">¶</a></h4>
<p>After succesfull completion of variants annotations data are transformed into tabular form and stored in relational database using custom operations.</p>
</section>
</section>
<section id="input-parameters">
<h3>Input parameters<a class="headerlink" href="#input-parameters" title="Permalink to this headline">¶</a></h3>
<p><cite>sample_input.json</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;design&quot;</span><span class="p">:</span> <span class="s2">&quot;test_design&quot;</span><span class="p">,</span>
  <span class="s2">&quot;fastq1_path&quot;</span><span class="p">:</span> <span class="s2">&quot;cwl_inputs_folder/germline-exome_tests/RG-corriell_S7_L001_R1_001.fastq.gz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;fastq2_path&quot;</span><span class="p">:</span> <span class="s2">&quot;cwl_inputs_folder/germline-exome_tests/RG-corriell_S7_L001_R2_001.fastq.gz&quot;</span><span class="p">,</span>
  <span class="s2">&quot;flowcell_id&quot;</span><span class="p">:</span> <span class="s2">&quot;JHDAXCKJDLSK&quot;</span><span class="p">,</span>
  <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span>
  <span class="s2">&quot;is_test&quot;</span><span class="p">:</span> <span class="s2">&quot;_tests&quot;</span><span class="p">,</span>
  <span class="s2">&quot;patient_id&quot;</span><span class="p">:</span> <span class="s2">&quot;germline_test_PID&quot;</span><span class="p">,</span>
  <span class="s2">&quot;phenotype&quot;</span><span class="p">:</span> <span class="s2">&quot;proband&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sample_id&quot;</span><span class="p">:</span> <span class="s2">&quot;germline_test_SID&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template_path&quot;</span><span class="p">:</span> <span class="s2">&quot;dags/cwl/configurations/templates/germline_exome_configuration_template.yaml&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="sample-rest-api-call">
<h3>Sample REST API call<a class="headerlink" href="#sample-rest-api-call" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -v -g -X POST <span class="se">\</span>
  http://localhost:8080/api/v1/dags/germline-exome/dagRuns <span class="se">\</span>
  -H <span class="s1">&#39;Cache-Control: no-cache&#39;</span> <span class="se">\</span>
  -H <span class="s1">&#39;Content-Type: application/json&#39;</span> <span class="se">\</span>
  -d <span class="s2">&quot;{&#39;conf&#39;:\&#39;</span><span class="k">$(</span>cat sample_input.json <span class="p">|</span> sed <span class="s1">&#39;s/\&quot;/\\&quot;/g&#39;</span><span class="k">)</span><span class="s2">\&#39;}&quot;</span>
</pre></div>
</div>
</section>
<section id="sample-airflow-cli-invocation">
<h3>Sample Airflow cli invocation<a class="headerlink" href="#sample-airflow-cli-invocation" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airflow dags trigger <span class="se">\</span>
-c <span class="s2">&quot;</span><span class="k">$(</span>cat sample_input.json<span class="k">)</span><span class="s2">&quot;</span> <span class="se">\</span>
-r dag_run-1 germline-exome
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">samgen</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">System overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pipelines overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#germline-exome">germline-exome</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tech_docs/tech_docs.html">Running pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../catalogue/catalogue.html">Data catalogue</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../overview/overview.html" title="previous chapter">System overview</a></li>
      <li>Next: <a href="../tech_docs/tech_docs.html" title="next chapter">Running pipelines</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Agnieszka Szmurło, Tomasz Gambin, Mateusz Dawidziuk, Dominika Maziec, Marek Wiewiórka.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/dags/dags.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>