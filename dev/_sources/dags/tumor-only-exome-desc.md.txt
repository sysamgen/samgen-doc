

Tumor only exome workflow based on [mgi-tumor-only-exome](https://github.com/genome/analysis-workflows/blob/master/definitions/pipelines/tumor_only_exome.cwl).

### Introduction
Tumor_only_exome is designed to perform processing of mutant/wildtype H.sapiens
exome sequencing data. It features BQSR corrected alignments, varscan variant
detection, and vep style annotations. In addition QC metrics are run.


### Alignment and QC step

Pipeline starts with either fastq files or unaligned BAM files with necessary metadata describing analysis type, sample name, gender, distinction between tumor and normal.

This step is performed seperately for normal and tumor sample.

.. image:: img/somatic-exome/alignment_qc.png

Used tools:
* [bwa_mem 0.7.15](10.1093/bioinformatics/btp324) - for sequence alignment step using GRCh38 reference
* [samblaster 0.1.24](https://doi.org/10.1093/bioinformatics/btu314) - for adding mate tags
* [flexbar 3.5](10.3390/biology1030895) - for bar and adapter removal 
* [picard:2.23.6](http://broadinstitute.github.io/picard/) for alignment metrics
* [samtools 1.11--h6270b1f_0](10.1093/bioinformatics/btp352) for BAM indexing and flagstat operation
* [picard 2.18.1](http://broadinstitute.github.io/picard/) - for bedtointervals operation
* [gatk 4.1.8.1](10.1101/gr.107524.110)  for Select Variants
* [verifyBamId v1.1.3](doi:10.1016/j.ajhg.2012.09.004) - for checking whether the reads are contaminated as a mixture of two samples
* [fastqc](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/) - for bam QC report
* [qualimap](10.1093/bioinformatics/btv566) - for bam QC report
* [multiqc](10.1093/bioinformatics/btw354) - QC 


### Detect variants step
This step is performed for tumor sample only.

.. image:: img/somatic-exome/detect_variants.png

Used tools:
* [varscan 2.4.2](10.1101/gr.129684.111) - for somatic variants detection
* [cle 1.4.2]()
* [vt 0.57721--hf74b74d_1](https://doi.org/10.1093/bioinformatics/btv112) - for normalization and decomposition
* [bcftools 1.12](10.1093/gigascience/giab008) - for vcf manipulations (merging, renaming samples)
* [samtools 1.11](10.1093/bioinformatics/btp352)  - for indexing and sanitizing BAM files (removing mutect-specific format tags, removing non ACTGN bases)
* [gatk 4.1.8.1](10.1101/gr.107524.110) - for DOCM variants detection and selecting, filtering variants
* [bcftools](10.1093/gigascience/giab008) - QC for detected variants


